---
title: "Gmail Notification In VB.NET"
layout: "post"
permalink: "/2012/04/gmail-notification-in-vbnet.html"
uuid: "4687912823480118293"
guid: "tag:blogger.com,1999:blog-102817447933978179.post-4687912823480118293"
date: "2012-04-28 17:49:00"
updated: "2012-09-12 06:12:10"
thumbnail: "http://4.bp.blogspot.com/-HHyUWkNGdow/T5wqWjIibQI/AAAAAAAAAsQ/lpbgxMm0nIU/s72-c/Capture.JPG"
description: 
blogger:
    siteid: "102817447933978179"
    postid: "4687912823480118293"
    comments: "1"
categories: [vb.net]
author: 
    name: "Ravin Singh D"
    url: "https://plus.google.com/105029459135081881791?rel=author"
    image: "//lh6.googleusercontent.com/-qFoJPNzk8as/AAAAAAAAAAI/AAAAAAAAIdA/vGXqRFCleH4/s32-c/photo.jpg"
---

{% raw %}
<div class="css-full-post-content js-full-post-content">
<div dir="ltr" style="text-align: left;" trbidi="on">Once again post related to vb.net.Now we are about how to develop simple gmail mail notification in vb.net. I refer the topic in <a href="http://www.dotnetcurry.com/ShowArticle.aspx?ID=292" target="_blank">Dotnet Curry Site</a> .But that site only have code for check the inbox in at one time when you run the program.<br /><br />i change the code for continuous monitor your inbox so that you get alert in every new message arrive<br />now we see how to design that<br /><br /><b>STEP 1:</b><br /><b>Design form as below </b><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-HHyUWkNGdow/T5wqWjIibQI/AAAAAAAAAsQ/lpbgxMm0nIU/s1600/Capture.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="171" src="http://4.bp.blogspot.com/-HHyUWkNGdow/T5wqWjIibQI/AAAAAAAAAsQ/lpbgxMm0nIU/s400/Capture.JPG" width="400" /></a></div><b>STEP 2:</b><br />Add following two component<br /><b>Timer Control</b><br /><b>Notifyicon</b><br /><b>&nbsp;</b> <br /><b>STEP 3:</b><br />code for form as below:<br /><br /><br /><b>Imports System.Xml<br />Imports System.Text</b><br /><b><br />Public Class Form1</b><br /><b><br />&nbsp;&nbsp;&nbsp; Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim node As XmlNode<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim objClient As New System.Net.WebClient<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim nodelist As XmlNodeList<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim response As String<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim xmlDoc As New XmlDocument<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objClient.Credentials = New System.Net.NetworkCredential(TextBox1.Text, TextBox2.Text)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response = Encoding.UTF8.GetString(objClient.DownloadData("https://mail.google.com/mail/feed/atom"))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response = response.Replace("&lt;feed version=""0.3"" xmlns=""http://purl.org/atom/ns#""&gt;", "&lt;feed&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlDoc.LoadXml(response)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node = xmlDoc.SelectSingleNode("/feed/fullcount")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailCount = node.InnerText<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If mailCount &gt; 0 Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReDim emailFrom(mailCount - 1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReDim emailMessages(mailCount - 1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nodelist = xmlDoc.SelectNodes("/feed/entry")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node = xmlDoc.SelectSingleNode("title")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each node In nodelist<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; emailMessages(tempCounter) = node.ChildNodes.Item(0).InnerText<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; emailFrom(tempCounter) = node.ChildNodes.Item(6).ChildNodes(1).InnerText<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tempCounter += 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tempCounter = 0<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NotifyIcon1.BalloonTipText = "you Have " + mailCount.ToString + " unread Message"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NotifyIcon1.ShowBalloonTip(1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Timer1.Start()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Hide()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Catch ex As Exception<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox(ex.Message)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Try<br />&nbsp;&nbsp;&nbsp; End Sub<br /><br />&nbsp;&nbsp;&nbsp; Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim node1 As XmlNode<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim xmldoc1 As New XmlDocument<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim response1 As String<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim objClient1 As New System.Net.WebClient<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim remail As Integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objClient1.Credentials = New System.Net.NetworkCredential(TextBox1.Text, TextBox2.Text)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response1 = Encoding.UTF8.GetString(objClient1.DownloadData("https://mail.google.com/mail/feed/atom"))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response1 = response1.Replace("&lt;feed version=""0.3"" xmlns=""http://purl.org/atom/ns#""&gt;", "&lt;feed&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmldoc1.LoadXml(response1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node1 = xmldoc1.SelectSingleNode("/feed/fullcount")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; remail = node1.InnerText<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If remail &gt; mailCount Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If remail &gt; old Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NotifyIcon1.BalloonTipText = "You Have " + remail.ToString + " New Mail"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NotifyIcon1.ShowBalloonTip(2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; old = remail<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Catch ex As Exception<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox(ex.Message)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Try<br />&nbsp;&nbsp;&nbsp; End Sub<br /><br />End Class</b><br /><br /><br /><b>STEP 4:</b><br />Add one class file<br />add new item-&gt;Class<br /><b>Step 5:</b><br />code for class file<br /><br /><b>Module GlobalVariables<br />&nbsp;&nbsp;&nbsp; Public emailFrom(1), emailMessages(1) As String<br />&nbsp;&nbsp;&nbsp; Public tempCounter As Int16 = 0<br />&nbsp;&nbsp;&nbsp; Public mailCount As Int16 = 0<br />&nbsp;&nbsp;&nbsp; Public old As Int32 = 0<br />End Module</b><br /><br /><b>Now run the form .Give your Gmail Account Details that will show how many mail are unread and if any mail are arrive that immediately show the alert to you</b><br /><br /><b>here the full solution file for gmail notification is available if you want download. Click the&nbsp;<a href="https://skydrive.live.com/redir.aspx?cid=dddef7b043cf9e7f&amp;resid=DDDEF7B043CF9E7F%21199&amp;parid=root" target="_blank">Link</a> </b><br />for any doubt please feel free contact me at ravin.singh75@gmail.com</div>
</div>
<div class="css-full-comments-content js-full-comments-content">
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="https://www.blogger.com/profile/07053000499986960864">
  <div class="css-comment-name js-comment-name">
    Christopher Cowman
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2013-05-30T15:32:43.067Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    Hi! Thanks for posting this :) I&#39;ve been searching the net trying to find a decent way to do this. I&#39;ll give it a shot and post how it turns out. 
  </div>
  <br/>
</div>
</div>
{% endraw %}